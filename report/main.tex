\documentclass[1pt, a4paper]{article}

\input{structure.tex}


\begin{document}
\maketitlepage
\tableofcontents
\newpage
\section{Introduction}
\label{sec:intro}
\noindent
In quantum mechanics the eigenstates of an Hamiltonian are really important, especially the ground state. This state is the one that is the most populated and it's teh satrting point for the study of light-matter interaction. This program goals to find this ground state for any Hamiltonian by partially diagonalise the Hamiltonian. We will try to use the power iterative method and the Lanczos algorithm. This program was written in Fortran 95 under manjaro. There are 3 f95 files. The first one is \f{main.f95}, wich is the main file. If you want to add a new Hamiltonian or choose a method to diagonalise one, it's in this file. The second file is  \f{state.f95}, wich contains all the code for the power iterative method (in the subroutine \f{subroutine state}). You don't have to modify this file. And the third one is \f{lanczos.f95}, which contains the code for the Lanczos algorithm (in the subroutine \f{subroutine lanczos}). You don't have to modify this file but this part of the code don't work so you can try to improve it if you want. There is a file named \f{main} wich is the compile form of the program. You can find all these files on \href{https://github.com/faucheresse/fortran-swimming-pool.git}{github}.
\section{Functional requirement of the program}
\label{sec:2}
\noindent
In the main file, you can find the \f{program pool}. In this program there is the creation of Hamiltonians that we want to diagonalize and the called of subroutines for each method. There are already 3 functions for Hamiltonians. There is also an "Hamiltonian" named \f{test}, wich looks like an Hamiltonian for tests. So after creating the Hamiltonian wanted you can use the \f{subroutine main}, wich create initial data and call the \f{subroutine state}, or the \f{subroutine lanczos} or both.
\subsection{Hamiltonians}
\label{sub:ham}
\noindent
For this program we had created 3 functions for Hamiltonian. There are tables to describe them :
\begin{table}[htbp]
    \begin{center}
        \begin{tabular}{p{0.3\linewidth} p{0.3\linewidth} p{0.3\linewidth}} \toprule
            \multicolumn{3}{c}{\f{function H_2lvl(omega, phi, delta)}}\\
            \midrule
            \hfil Description & \hfil Input & \hfil Output\\
            \cmidrule(r){1-1} \cmidrule{2-2} \cmidrule(l){3-3}
           
            This function retrieve a Hamiltonian for a 2 level atom interacting with laser fields.&
            \vspace*{-8pt}
            \begin{itemize}[leftmargin=15pt, itemsep=0pt, topsep=0pt]
            \item \f{omega} : the laser amplitude multiplied by the atomic dipolar moment amplitude.
            \item \f{phi} : the laser phase.
            \item \f{delta} : the detuning.
            \end{itemize}
            &
            This function will retrieve a 2x2 matrix.\\
            \bottomrule
        \end{tabular}
    \end{center}
    \caption{\f{function H_2lvl}}
    \label{tab:H2lvl}
\end{table}
\newpage\noindent
\begin{table}[htbp]
    \begin{center}
        \begin{tabular}{p{0.3\linewidth} p{0.3\linewidth} p{0.3\linewidth}} \toprule
            \multicolumn{3}{c}{\f{function H_3lvl(omega_p, phi_p, delta_p, omega_s, phi_s, delta_s)}}\\
            \midrule
            \hfil Description & \hfil Input & \hfil Output\\
            \cmidrule(r){1-1} \cmidrule{2-2} \cmidrule(l){3-3}
           
            This function retrieve a Hamiltonian for a 3 level atom interacting with laser fields.&
            The "p" is for pump mode and "s" for Stokes mode.
            \begin{itemize}[leftmargin=15pt, itemsep=0pt, topsep=0pt]
            \item \f{omega_p/omega_s} : the laser amplitude multiplied by the atomic dipolar moment amplitude.
            \item \f{phi_p/phi_s} : the laser phase.
            \item \f{delta_p/delta_s} : the detuning.
            \end{itemize}
            &
            This function will retrieve a 3x3 matrix.\\
            \bottomrule
        \end{tabular}
    \end{center}
    \caption{\f{function H_2lvl}}
    \label{tab:H3lvl}
\end{table}
\begin{table}[htbp]
    \begin{center}
        \begin{tabular}{p{0.3\linewidth} p{0.3\linewidth} p{0.3\linewidth}} \toprule
            \multicolumn{3}{c}{\f{function molecular_H(N, L, m)}}\\
            \midrule
            \hfil Description & \hfil Input & \hfil Output\\
            \cmidrule(r){1-1} \cmidrule{2-2} \cmidrule(l){3-3}
           
            This function retrieve a molecular kinetic Hamiltonian.&
            \vspace*{-8pt}
            \begin{itemize}[leftmargin=15pt, itemsep=0pt, topsep=0pt]
            \item \f{N} : number of particle (size of the Hamiltonian)
            \item \f{L} : size of the molecule
            \item \f{m} : mass of the molecule
            \end{itemize}
            &
            This function will retrieve a NxN matrix, wich is diagonal.\\
            \bottomrule
        \end{tabular}
    \end{center}
    \caption{\f{function H_2lvl}}
    \label{tab:mol_H}
\end{table}
After using the \f{function molecular_H} you have to add to it the wanted potential to the kinetic Hamiltonian (all of them are commented under the example call). There are three different potatentials.
\begin{itemize}[leftmargin=15pt, itemsep=0pt, topsep=0pt]
    \item Particle in a box (\f{function box_potential(N, L)})
        \begin{equation}
            V(x) = \left\{\begin{array}{ll}
                            +\infty&if\;x=0\\
                            0\;\quad&if\;x\in ]0,L[\\
                            +\infty&if\;x=L
                          \end{array}\right.
        \end{equation}
    \item Harmonic oscillator (\f{function ho_potential(N, L, k)})
        \begin{equation}
            V(x) = \dfrac{1}{2}k\left(x - \dfrac{L}{2}\right)^2
        \end{equation}
    \item Vibration of the $H_2^+$ molecule (\f{function molecular_potential(N, L, V0, a)})
        \begin{equation}
            V(x) = V_0\left(\e^{-2a(x-x_0)} - 2\e^{a(x-x_0)}\right)
        \end{equation}
\end{itemize}
\newpage
\section{Internal structure of the program}
\label{sec:3}
\noindent
\subsection{Description of the diagonalization algorithms}
\label{sub:diag}
\noindent
\subsubsection{The power method algorithm}
\label{subs:pow}
\noindent
The power method algorithm consist to apply a matrix to a vector an infinite number of time. So to find the eigenvector we have :
\begin{equation}
\label{eq:eig}
    \ket{\phi_0} = H^{\infty}\ket{\psi}
\end{equation}
With $H$ the matrix we want to diagonalize, $\ket{\phi_0}$ the eigenvector ans $\ket{\psi}$ a random vector. So the associated eigenvalue, $\lambda_i$, is $\lambda_i = \Braket{\phi_0}{M}{\phi_0}$.\\
But we can't apply an infinite number of time a matrix to a vector. So we will transform a little the \autoref{eq:eig} and for the numerical calculation add a condition to stop before the infinity. We rewrite the \autoref{eq:eig} as :
\begin{equation}
    \lim_{k\rightarrow +\infty} \dfrac{H^k\ket{\psi}}{||H^k\ket{\psi}||} = \ket{\phi_0}
\end{equation}
In our case $H$ is a Hamiltonian, so it is a hermitian matrix with a negative spectrum. And we want to find the ground state which is the lowest eigenvalue of $H$. The lowest eigenvalue is $\lambda_0 = \Braket{\phi_0}{H}{\phi_0}$. So we will stop the computation when :
\begin{equation}
    ||H\ket{\phi_0} - \Braket{\phi_0}{H}{\phi_0}\ket{\phi_0}|| > \epsilon
\end{equation}
It is when the lowest eigenvalue it is a solution of the eigenequation for the ground state. With that we can write a pseudo-code to find the ground state.\\
\hrule
\noindent
\\
take a random vector $\phi_0$\\
normalize $\phi_0$\\
$H \leftarrow H - shift * id$\\
while $||H\phi_0 - \Braket{\phi_0}{H}{\phi 0}\phi_0|| > \epsilon$ and $k\leq k_{max}$ do\\
$\quad \phi_0 \leftarrow H\phi_0$\\
$\quad$ normalize $\phi_0$\\
$\quad k \leftarrow k + 1$\\
end while\\
$H \leftarrow H + shift * id$\\
$\lambda_0 \leftarrow \Braket{\phi_0}{H}{\phi_0}$\\
\hrule
\noindent
\\
$shift$ is a shift value to ensure a negative spectrum.\\
By using this method we can also find the first exited state by projecting onto an ortogonal component to avoid non-zero component from $\phi_0$ appearig into $\phi_1$. So we can write the following pseudo-code :\\
\hrule
\noindent
\\
take a random vector $\phi_1$\\
$\phi_1 \leftarrow \phi_1 - \braket{\phi_0}{\phi_1}\phi_0$\\
normalize $\phi_1$\\
$H \leftarrow H - shift * id$\\
while $||H\phi_0 - \Braket{\phi_1}{H}{\phi 1}\phi_1|| > \epsilon$ and $k\leq k_{max}$ do\\
$\quad \phi_1 \leftarrow H\phi_1$\\
$\quad\phi_1 \leftarrow \phi_1 - \braket{\phi_0}{\phi_1}\phi_0$\\
$\quad$ normalize $\phi_1$\\
$\quad k \leftarrow k + 1$\\
end while\\
$H \leftarrow H + shift * id$\\
$\lambda_1 \leftarrow \Braket{\phi_1}{H}{\phi_1}$\\
\hrule
\noindent
\newpage\noindent
After that $phi_0$ is the ground state and $\phi_1$ is the first exited state, $\lambda_0$ and $\lambda_1$ are the associated eigenvalues.
\subsubsection{The Lanczos algorithm}
\label{subs:lanczos}
\noindent


% \begin{table}[htbp]
%     \begin{center}
%         \begin{tabular}{p{0.3\linewidth} p{0.3\linewidth} p{0.3\linewidth}} \toprule
%             \multicolumn{3}{c}{\py{name}}\\
%             \midrule
%             \hfil Description & \hfil Input & \hfil Output\\
%             \cmidrule(r){1-1} \cmidrule{2-2} \cmidrule(l){3-3}
           
%             This function computes the Shannon entropy over time of $\theta$. So for each vector of the list of vectors \py{theta}&
            % \vspace*{-8pt}
            % \begin{itemize}[leftmargin=15pt, itemsep=0pt, topsep=0pt]
                % \setlength{\itemsep}{0pt}
                % \item \py{"random"}
                % \item \py{"chimera"}
                % \item \py{"inverse"}
                % \item \py{"josephson"}
                % \end{itemize}
%             &
%             This function will retrieve two data files in the parameters directory.
%             \begin{itemize}[leftmargin=15pt, itemsep=0pt, topsep=0pt]
%                 \item \py{"S.dat"} : It contains a list of real of size T. \py{S} represents the Shannon entropy over time of each vector of \py{theta}
%             \end{itemize}\\
%             \bottomrule
%         \end{tabular}
%     \end{center}
%     \caption{function}
%     \label{tab:label}
% \end{table}

% \begin{figure}[htbp]
%     \centering
%     \includegraphics[width=.95\linewidth]{../outcomes/josephson/phase.png}
%     \caption{Complex mean of phase josephson arrays}
%     \label{fig:phase_j}
% \end{figure}

% \newpage
% \bibliographystyle{plain}
% \bibliography{biblio}
\end{document}